<div class="p-40">
  <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px;">

    <div style="background: linear-gradient(135deg, #1a73e8 0%, #0d47a1 100%); color: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(26,115,232,0.3);">
      <h4 style="margin: 0; opacity: 0.8; font-size: 14px; text-transform: uppercase;">Receita Total Prevista</h4>
      <p style="font-size: 32px; font-weight: bold; margin: 10px 0;">{{ faturamentoTotal | currency:'BRL' }}</p>
      <span style="font-size: 12px;">Baseado em {{ listaPacientes.length }} pacientes ativos</span>
    </div>

    <div style="background: white; padding: 25px; border-radius: 12px; border: 1px solid #e0e0e0; border-left: 5px solid #1a73e8;">
      <h4 style="margin: 0; color: #5f6368; font-size: 14px;">Total Pré-Operatório</h4>
      <p style="font-size: 28px; font-weight: bold; margin: 10px 0; color: #1a73e8;">{{ faturamentoPre | currency:'BRL' }}</p>
      <small>{{ faturamentoPre / configFinanceira.mensalPreOp }} pacientes</small>
    </div>

    <div style="background: white; padding: 25px; border-radius: 12px; border: 1px solid #e0e0e0; border-left: 5px solid #34a853;">
      <h4 style="margin: 0; color: #5f6368; font-size: 14px;">Total Recebido</h4>
      <p style="font-size: 28px; font-weight: bold; margin: 10px 0; color: #34a853;">{{ faturamentoRealizado | currency:'BRL' }}</p>
      <small>Eficiência financeira</small>
    </div>
  </div>

  <div class="card-lista-geral" style="background: white; padding: 25px; border-radius: 12px; border: 1px solid #ddd; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
    <h3 style="margin-bottom: 20px; color: #202124;">Listagem de Cobrança Mensal</h3>
    <table style="width: 100%; border-collapse: collapse;">
      <thead>
      <tr style="background: #f8f9fa; border-bottom: 2px solid #eee;">
        <th style="padding: 15px; text-align: left; color: #5f6368;">Paciente</th>
        <th style="padding: 15px; text-align: left; color: #5f6368;">Plano</th>
        <th style="padding: 15px; text-align: left; color: #5f6368;">Valor Mensal</th>
        <th style="padding: 15px; text-align: left; color: #5f6368;">Ações / Status</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let p of listaPacientes" style="border-bottom: 1px solid #eee;">
        <td style="padding: 15px;"><strong>{{ p.nome }}</strong></td>
        <td style="padding: 15px;">{{ p.plano === 'mensalPreOp' ? 'Pré-Operatório' : 'Pós-Operatório' }}</td>
        <td style="padding: 15px;">{{ (p.plano === 'mensalPreOp' ? configFinanceira.mensalPreOp : configFinanceira.mensalPosOp) | currency:'BRL' }}</td>
        <td style="padding: 15px;">
          <button (click)="alternarPagamento(p)"
                  [style.background]="(p.pagoEsteMes || p.pago_este_mes) ? '#e6f4ea' : '#fce8e6'"
                  [style.color]="(p.pagoEsteMes || p.pago_este_mes) ? '#1e8e3e' : '#d93025'"
                  style="border: none; padding: 8px 15px; border-radius: 20px; font-size: 12px; font-weight: bold; cursor: pointer; min-width: 100px;">
            {{ (p.pagoEsteMes || p.pago_este_mes) ? '✓ PAGO' : '⚠ PENDENTE' }}
          </button>
        </td>
      </tr>
      <tr *ngIf="listaPacientes.length === 0">
        <td colspan="4" style="text-align: center; padding: 30px; color: #70757a;">Nenhum paciente ativo encontrado.</td>
      </tr>
      </tbody>
    </table>
  </div>
</div>
